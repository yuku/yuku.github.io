(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[75],{8603:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return h}});var o=t(809),a=t.n(o),l=t(5311),r=t(5893),i=(t(7294),t(7871)),s=t(6265),c=t(8347),p=t(3905);function u(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?u(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var m={};function k(e){var n=e.components,t=(0,c.Z)(e,["components"]);return(0,p.kt)("wrapper",d(d(d({},m),t),{},{components:n,mdxType:"MDXLayout"}),(0,p.kt)("p",null,"The one thing you can't avoid when using GCP is the ",(0,p.kt)("a",d({parentName:"p"},{href:"https://cloud.google.com/sdk/"}),"Google Could SDK"),". However, I don't want to install a tool on the local machine's system globals if possible."),(0,p.kt)("p",null,"So I decided to use ",(0,p.kt)("a",d({parentName:"p"},{href:"https://hub.docker.com/r/google/cloud-sdk/"}),"google/cloud-sdk"),", the official Google Docker image, in my local environment."),(0,p.kt)("h2",null,"Prepare Docker Images"),(0,p.kt)("p",null,"There are three types of tags for google/cloud-sdk:"),(0,p.kt)("ul",null,(0,p.kt)("li",{parentName:"ul"},(0,p.kt)("inlineCode",{parentName:"li"},"latest"),", ",(0,p.kt)("inlineCode",{parentName:"li"},"VERSION"),": Large image with ",(0,p.kt)("a",d({parentName:"li"},{href:"https://cloud.google.com/sdk/downloads#apt-get"}),"additional components")," pre-installed, Debian-based."),(0,p.kt)("li",{parentName:"ul"},(0,p.kt)("inlineCode",{parentName:"li"},"slim"),", ",(0,p.kt)("inlineCode",{parentName:"li"},"VERSION-slim"),": Smaller image with no components pre-installed, Debian-based."),(0,p.kt)("li",{parentName:"ul"},(0,p.kt)("inlineCode",{parentName:"li"},"alpine"),", ",(0,p.kt)("inlineCode",{parentName:"li"},"VERSION-alpine"),": Smallest image with no additional components installed, Alpine-based.")),(0,p.kt)("p",null,"I wanted to use Google AppEngine & AppEngine components is included in the default components, so I decided to use ",(0,p.kt)("inlineCode",{parentName:"p"},"alpine"),":"),(0,p.kt)("pre",d({},{className:"language-bash"}),(0,p.kt)("code",d({parentName:"pre"},{className:"language-bash"}),"docker pull google/cloud-sdk:alpine\ndocker run -it --rm google/cloud-sdk:alpine gcloud version\n",(0,p.kt)("span",d({parentName:"code"},{className:"token comment"}),"# Google Cloud SDK 229.0.0"),"\n",(0,p.kt)("span",d({parentName:"code"},{className:"token comment"}),"# bq 2.0.39"),"\n",(0,p.kt)("span",d({parentName:"code"},{className:"token comment"}),"# core 2019.01.04"),"\n",(0,p.kt)("span",d({parentName:"code"},{className:"token comment"}),"# gsutil 4.35"),"\n")),(0,p.kt)("h2",null,"Auth"),(0,p.kt)("p",null,"Specify ",(0,p.kt)("inlineCode",{parentName:"p"},"--name")," option to persist auth information:"),(0,p.kt)("pre",d({},{className:"language-bash"}),(0,p.kt)("code",d({parentName:"pre"},{className:"language-bash"}),"docker run -it --name gcloud-config ",(0,p.kt)("span",d({parentName:"code"},{className:"token punctuation"}),"\\"),"\n    google/cloud-sdk:alpine gcloud auth login\n")),(0,p.kt)("p",null,"Copy and paste the displayed URL into the browser and follow the instructions, and finally copy and paste the verification code displayed on the screen into the terminal."),(0,p.kt)("h2",null,"Use SDK"),(0,p.kt)("p",null,"Use ",(0,p.kt)("inlineCode",{parentName:"p"},"--volumes-from gcloud-config")," to mount the volume containing the auth information:"),(0,p.kt)("pre",d({},{className:"language-bash"}),(0,p.kt)("code",d({parentName:"pre"},{className:"language-bash"}),"docker run --rm --volumes-from gcloud-config ",(0,p.kt)("span",d({parentName:"code"},{className:"token punctuation"}),"\\"),"\n    google/cloud-sdk:alpine gcloud config list\n")),(0,p.kt)("h2",null,"References"),(0,p.kt)("ul",null,(0,p.kt)("li",{parentName:"ul"},(0,p.kt)("a",d({parentName:"li"},{href:"https://cloud.google.com/sdk/docs/quickstart-mac-os-x"}),"Quickstart for macOS \xa0|\xa0 Cloud SDK Documentation \xa0|\xa0 Google Cloud")),(0,p.kt)("li",{parentName:"ul"},(0,p.kt)("a",d({parentName:"li"},{href:"https://hub.docker.com/r/google/cloud-sdk/"}),"google/cloud-sdk - Docker Hub"))))}k.isMDXComponent=!0;var g=function(e){var n=e.meta;return(0,r.jsx)(i.i,{meta:n,children:(0,r.jsx)(k,{})})};g.getInitialProps=(0,l.Z)(a().mark((function e(){var n,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t(405),o=n.entries,e.abrupt("return",{meta:o["blog/2019/01/google-cloud-sdk-in-docker"]});case 2:case"end":return e.stop()}}),e)})));var h=g},6730:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/2019/01/google-cloud-sdk-in-docker",function(){return t(8603)}])}},function(e){e.O(0,[885,663,774,888,179],(function(){return n=6730,e(e.s=n);var n}));var n=e.O();_N_E=n}]);