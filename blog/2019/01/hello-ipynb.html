<!DOCTYPE html><html prefix="og: http://ogp.me/ns#"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="apple-touch-icon" sizes="57x57" href="/static/icons/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/static/icons/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/static/icons/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/static/icons/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/static/icons/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/static/icons/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/static/icons/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/static/icons/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/static/icons/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/static/icons/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/icons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/static/icons/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/icons/favicon-16x16.png"/><link rel="icon" href="/static/icons/favicon.ico"/><link rel="manifest" href="/static/config/manifest.json"/><meta name="msapplication-TileColor" content="#00BCD4"/><meta name="msapplication-TileImage" content="/static/icons/ms-icon-144x144.png"/><meta name="msapplication-config" content="/static/config/browserconfig.xml"/><meta name="google-site-verification" content="uoCr1A890A-K8B7GkFUvLlQ5ihZlFyR6gzvt4F-62u0"/><link href="https://fonts.googleapis.com/css?family=Noto+Sans+JP:300,400,700|Damion" rel="stylesheet"/><link rel="alternate" type="application/rss+xml" href="/static/rss-feed.xml"/><title>Display Jupyter Notebook on Next.js - yt coffee</title><meta name="description" content="Jupyter Notebook can now be displayed on this blog. I&#x27;m going to use it to publish my study records of machine learning and data analysis. This article describes the details of the implementation."/><meta name="twitter:card" content="summary"/><meta name="twitter:creator" content="@yuku_t"/><meta property="fb:app_id" content="1188125924685915"/><meta property="og:title" content="Display Jupyter Notebook on Next.js - yt coffee"/><meta property="og:type" content="article"/><meta property="og:url" content="https://yuku.takahashi.coffee/blog/2019/01/hello-ipynb"/><meta property="og:image" content="https://yuku.takahashi.coffee/static/images/haniwa.jpg"/><meta property="og:description" content="Jupyter Notebook can now be displayed on this blog. I&#x27;m going to use it to publish my study records of machine learning and data analysis. This article describes the details of the implementation."/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css"/><meta name="next-head-count" content="35"/><link rel="preload" href="/_next/static/css/4bf513bb785bfc6e5255.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4bf513bb785bfc6e5255.css"/><link rel="preload" href="/_next/static/css/716c005ded1f00a3813d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/716c005ded1f00a3813d.css"/><link rel="preload" href="/_next/static/QswxI-fIs2-hd0XYyGH62/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/QswxI-fIs2-hd0XYyGH62/pages/blog/2019/01/hello-ipynb.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.ca3e7fa29692f350ed1d.js" as="script"/><link rel="preload" href="/_next/static/chunks/a9a7754c.e804e3632f934e5e846b.js" as="script"/><link rel="preload" href="/_next/static/chunks/cb1608f2.1f284ae5b2e415eb6264.js" as="script"/><link rel="preload" href="/_next/static/chunks/573325d7.58471afdb7a4755dfa0b.js" as="script"/><link rel="preload" href="/_next/static/chunks/957122c6ff222a542e4f39a01b97f8864e73f417.49b260e1bcb8a40fc5df.js" as="script"/><link rel="preload" href="/_next/static/chunks/abff2ad3dbe954632857b3cc324a66fa847862b5.1674fc9a354818602eed.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-9112e348e17a95b21e5e.js" as="script"/><link rel="preload" href="/_next/static/chunks/75fc9c18.3cfc8ccb85c1d7a11215.js" as="script"/><link rel="preload" href="/_next/static/chunks/74cbb81d2d2475ed3b6cd8231d14b9846dcb24c5.7a766718aeb8a0b9e59f.js" as="script"/></head><body><div id="__next"><div class="layout mx-md-auto d-md-flex"><nav class="topbar-mobile d-flex justify-content-between d-md-none py-4 px-3"><a href="/" class="brand">yt coffee</a><button class="border-0 bg-transparent text-black-50"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars fa-w-14 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></button></nav><div class="side-menu d-md-block px-3 p-lg-5 py-4"><div class="side-menu-inner"><a href="/" class="brand">yt coffee</a><p class="text-muted font-weight-light pt-1"><small>Study hard, play harder.</small></p><ul class="list list-unstyled"><li class=""><a href="/">Home</a></li><li class=""><a href="/about">About Me</a></li><li class=""><a href="/resume">Resume</a></li></ul></div></div><div class="flex-md-grow-1 bg-white px-sm-3 pt-lg-5 py-4 overflow-hidden"><div class="blogpage container"><div class="row"><main class="col-xl-8 notebook"><article itemscope="" itemType="http://schema.org/BlogPosting"><meta itemProp="author" content="Yuku Takahashi"/><meta itemProp="datePublished" content="2019-01-15T20:17:00+09:00"/><meta itemProp="dateModified" content="2020-05-30T00:43:29+09:00"/><meta itemProp="image" content="https://yuku.takahashi.coffee/static/images/haniwa.jpg"/><header class="mb-4 header"><h1 class="headline" itemProp="headline">Display Jupyter Notebook on Next.js</h1><ul class="list-inline text-dark font-weight-light"><li class="list-inline-item"><span class="ml-1">2019-01-15 11:17</span></li><li class="list-inline-item"><span class="ml-1">#<!-- -->Blog dev</span></li></ul></header><section class="mb-4 body" itemProp="articleBody"><div class="nb-notebook"><div class="nb-worksheet"><div class="nb-cell nb-markdown-cell"><p>Commit: <a href="https://github.com/yuku/yuku.github.io/commit/1c18e263dcc3ca54c0061ccda57b4bca8ba9f9fd">yuku/yuku.github.io@<code>1c18e26</code></a></p><p>Jupyter Notebook can now be displayed on this blog. I&#x27;m going to use it to publish my study records of machine learning and data analysis. üí™üèº</p></div><div class="nb-cell nb-code-cell"><div class="nb-input" data-prompt-number="1"><pre class="language-python"><code class="language-python" data-language="python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world&quot;</span><span class="token punctuation">)</span></code></pre></div><div class="nb-output" data-prompt-number="1"><pre class="nb-stdout">Hello world<!-- -->
</pre></div></div><div class="nb-cell nb-markdown-cell"><p>This article describes the details of the implementation.</p><h2>Display ipynb files on Next.js</h2><p>In order to display ipynb files on Next.js, I needed to do two things:</p><ol><li>Make a ipynb file readable by Webpack.</li><li>Convert a loaded ipynb file into a React Component.</li></ol><h3>Make ipynb files readable</h3><p>Next.js uses Webpack for file resolution, so you can use <a href="https://www.npmjs.com/package/ipynb-loader">ipynb-loader</a>. This loader does nothing more than call <a href="https://github.com/jupyter/nbconvert">jupyter/nbconvert</a> internally and return the result. jupyter/nbconvter provides the ability to convert ipynb files to HTML, Markdown, etc.</p><p>When using jupyter/nbconvert, I had to decide whether to output as HTML or Markdown</p><p>If outputting in HTML, I can easily display the characteristic <code>In [1]</code> prompt of Jupyter Notebook, but on the other hand, it is difficult to use some desired features such as LaTex notation. <sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup></p><p>When outputting as Markdown, not only I can use the same processing as MDX, but I can also use Markdown notation that Jupyter Notebook does not support, which is an advantage. On the other hand, the correspondence between input and output is lost, so it doesn&#x27;t feel like a Jupyter Notebook is displayed.</p><p>After all, when I want to write a blog in ipynb format, I want to express the correspondence between input and output, and if I want to use LaTex, for example, I can write in MDX format, so I decided to output in HTML.</p><h3>Convert to a React Component</h3><p>Next.js expects to import a React Component. This means that Webpack needs to generate a string that can be interpreted as a React Component.</p><p>JSX is useful for writing a React Component. Unfortunately, I couldn&#x27;t find a Webpack loader that would accomplish this goal, so I implemented such loader by myself using <a href="https://www.npmjs.com/package/htmltojsx">htmltojsx</a>, which is written by Facebook:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token maybe-class-name">HTMLtoJSX</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;htmltojsx&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> converter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HTMLtoJSX</span><span class="token punctuation">(</span><span class="token punctuation">{</span> createClass<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<!-- -->
<!-- -->module<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<!-- -->  <span class="token comment">// The `content` argument is the HTML returned by ipynb-loader.</span>
<!-- -->  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
<!-- -->  <!-- -->import React from &quot;react&quot;<!-- -->
<!-- -->  <!-- -->export default () =&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$<!-- -->{</span>converter<span class="token punctuation">.</span><span class="token method function property-access">convert</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
<!-- -->  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
</code></pre><h2>Notes</h2><ul><li>I&#x27;ve been generated entries.ts file, which is a collection of metadata written in MDX files during compilation, but ipynb doesn&#x27;t support such metadata, so I gave up on automatically generating the file and decided to manage it manually.</li><li>Using jupyter/nbconvert to generate HTML from ipynb made the Blog&#x27;s architecture complex, and I had to switch from Travis CI to CircleCI to maintain auto-deployment. Since ipynb is a JSON, it may be good to reimplement it with JavaScript. In that case, it seems that the part that converts Markdown to HTML can be shared with MDX.</li></ul><h2>Conclusion</h2><p>In my next job, I&#x27;m going to use pyspark to analyze data, so I&#x27;d like to use this feature to publish the knowledge I&#x27;ve gained while leaning pyspark and using it.</p><p>This is the first time I&#x27;ve written a webpack loader, and it&#x27;s easier than I thought it would be. Through this implementation, I have learned Webpack itself well. If you feel that you don&#x27;t know what Webpack is doing, you may be able to understand Webpack better by writing a loader.</p><div class="footnotes"><hr/><ol><li id="fn-1">Jupyter Notebook implements LaTex notation using MathJax, but in this blog, I try not to run JS on the browser as much as possible, so I use <a href="https://www.npmjs.com/package/remark-math">remark-math</a> and <a href="https://www.npmjs.com/package/rehype-katex">rehype-katex</a> to convert LaTex notation to HTML at compile time.<a href="#fnref-1" class="footnote-backref">‚Ü©</a></li></ol></div></div></div></div></section></article></main><div class="col-xl-4"><div class="pl-xl-2"><aside class="widget mb-4"><h1 class="title font-weight-bold">About Me</h1><div><img src="/static/images/haniwa.jpg" alt="avatar" class="avatar rounded-circle mb-4 mx-auto d-block"/><p>Software Engineer at FLYWHEEL. Working mainly on recommendation systems in these days. Ex-Qiita CTO.<a href="/about" style="margin-left:4px">Read more</a>.</p></div></aside><aside class="widget mb-4"><h1 class="title font-weight-bold">Follow</h1><ul class="list-inline icons"><li class="list-inline-item"><a href="https://twitter.com/yuku_t"><span class="fa-stack fa-lg"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="circle" class="svg-inline--fa fa-circle fa-w-16 fa-stack-2x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"></path></svg><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter fa-w-16 fa-inverse fa-stack-1x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></span></a></li><li class="list-inline-item"><a href="https://github.com/yuku"><span class="fa-stack fa-lg"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="circle" class="svg-inline--fa fa-circle fa-w-16 fa-stack-2x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"></path></svg><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16 fa-inverse fa-stack-1x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span></a></li><li class="list-inline-item"><a href="/static/rss-feed.xml"><span class="fa-stack fa-lg"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="circle" class="svg-inline--fa fa-circle fa-w-16 fa-stack-2x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"></path></svg><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" class="svg-inline--fa fa-rss fa-w-14 fa-inverse fa-stack-1x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg></span></a></li></ul></aside></div></div></div></div><footer class="text-center mt-4"><p class="mb-0 text-dark"><small>¬© Yuku Takahashi <!-- -->2020<!-- --> - This work is licensed under a<!-- --> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 </a></small></p></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"meta":{"description":"Jupyter Notebook can now be displayed on this blog. I'm going to use it to publish my study records of machine learning and data analysis. This article describes the details of the implementation.","format":"ipynb","modifiedAt":"2020-05-30T00:43:29+09:00","publishedAt":"2019-01-15T20:17:00+09:00","tags":["Blog dev"],"title":"Display Jupyter Notebook on Next.js"}}},"page":"/blog/2019/01/hello-ipynb","query":{},"buildId":"QswxI-fIs2-hd0XYyGH62","nextExport":true,"isFallback":false,"gip":true,"appGip":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-3e5045aba54bf19a65e4.js"></script><script async="" data-next-page="/_app" src="/_next/static/QswxI-fIs2-hd0XYyGH62/pages/_app.js"></script><script async="" data-next-page="/blog/2019/01/hello-ipynb" src="/_next/static/QswxI-fIs2-hd0XYyGH62/pages/blog/2019/01/hello-ipynb.js"></script><script src="/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="/_next/static/chunks/framework.ca3e7fa29692f350ed1d.js" async=""></script><script src="/_next/static/chunks/a9a7754c.e804e3632f934e5e846b.js" async=""></script><script src="/_next/static/chunks/cb1608f2.1f284ae5b2e415eb6264.js" async=""></script><script src="/_next/static/chunks/573325d7.58471afdb7a4755dfa0b.js" async=""></script><script src="/_next/static/chunks/957122c6ff222a542e4f39a01b97f8864e73f417.49b260e1bcb8a40fc5df.js" async=""></script><script src="/_next/static/chunks/abff2ad3dbe954632857b3cc324a66fa847862b5.1674fc9a354818602eed.js" async=""></script><script src="/_next/static/runtime/main-9112e348e17a95b21e5e.js" async=""></script><script src="/_next/static/chunks/75fc9c18.3cfc8ccb85c1d7a11215.js" async=""></script><script src="/_next/static/chunks/74cbb81d2d2475ed3b6cd8231d14b9846dcb24c5.7a766718aeb8a0b9e59f.js" async=""></script><script src="/_next/static/QswxI-fIs2-hd0XYyGH62/_buildManifest.js" async=""></script><script src="/_next/static/QswxI-fIs2-hd0XYyGH62/_ssgManifest.js" async=""></script></body></html>